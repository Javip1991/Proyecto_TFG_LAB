<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="/css/style.css" />
    <title><%= title || "Laboratorio Broken Authentication" %></title>
  </head>
  <body>



    <h1>Laboratorio Broken Authentication</h1>

    <% if (typeof isVulnerableSuccess !== 'undefined' && isVulnerableSuccess) { %>
  <div class="alert-danger">
    丘멆잺 Vulnerabilidad explotada: el sistema no verifica la contrase침a.
  </div>
<% } %>

<% if (typeof lastResult !== 'undefined') { %>
  <h4>Resultado:</h4>
  <pre class="<%= lastResult.includes('fallido') ? 'failure' : 'success' %>">
<%= lastResult %>
  </pre>
<% } %>

    <h3>
      Modo actual:
      <span class="<%= mode === 'vulnerable' ? 'mode-vulnerable' : 'mode-secure' %>">
        <%= mode.toUpperCase() %>
      </span>
    </h3>

    <a href="/labs/broken-auth/switch-mode" class="btn">
      Cambiar a modo <%= mode === "vulnerable" ? "SEGURO" : "VULNERABLE" %>
    </a>

    <p>Bienvenido al laboratorio de Broken Authentication (BA). En este laboratorio podr치s experimentar con la vulnerabilidad BA, que consiste en 
    manipular logins mediante entradas maliciosas, pudiendo asi acceder a cuentas sin autorizaci칩n.
    esta vulnerabilidad es especialmente peligrosa porque puede permitir a un atacante acceder a informaci칩n sensible o realizar acciones en nombre de otros usuarios.

      <h4>游댏 Pasos para explotar la vulnerabilidad:</h4>

    Prueba a introducir en el formulario de abajo algunos textos como: 

 <table border="1" cellpadding="8" cellspacing="0">
  <tr>
    <th>Username</th>
    <th>Password</th>
  </tr>
  <tr>
    <td><code>user1</code></td>
    <td><code>cualquiera</code></td>
  </tr>
  <tr>
    <td><code>admin</code></td>
    <td><code>cualquiera</code></td>
  </tr>

         </table>

    y ver치s c칩mo se comporta la p치gina al introducir estas credenciales. Despues de varios intentos fallidos, la cuenta se bloquear치 y no podr치s acceder a ella.</p>

    <p>Tambien puedes probar a introducir en el login las credenciales reales de usuarios que ya estan en la base de datos para ver como se comporta la pagina.</p>
    
         <table border="1" cellpadding="8" cellspacing="0">
          <tr>
            <th>Username</th>
            <th>Password</th>
          </tr>
          <tr>
            <td><code>admin</code></td>
            <td><code>123456</code></td>
          </tr>
          <tr>
            <td><code>user1</code></td>
            <td><code>password</code></td>
          </tr>

         </table>


    <hr>

    <form action="/labs/broken-auth/auth" method="POST">
      <label>Username:</label><br>
      <input type="text" name="username" required /><br><br>

      <label>Password:</label><br>
      <input type="password" name="password" required /><br><br>

      <button type="submit" class="btn">Iniciar sesi칩n</button>
    </form>

    <% if (typeof lastResult !== 'undefined') { %>
      <h4>Resultado:</h4>
      <pre class="<%= lastResult.includes('fallido') ? 'failure' : 'success' %>">
        <%= lastResult %>
      </pre>

      <% if (typeof explanation !== 'undefined') { %>
      <h4>Explicaci칩n t칠cnica:</h4>
     <pre><%= explanation %></pre>
      <% } %>

    <% } %>
    <hr>

    <p><a href="/labs/broken-auth/code" class="btn">Mostrar c칩digo vulnerable</a></p>
    <a href="/" class="btn">Volver</a>

   
  </body>
</html>